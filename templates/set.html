<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <title>B√†i √¥n</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">

    <!-- Modal CSS (thu·∫ßn - kh√¥ng c·∫ßn Bootstrap) -->
    <style>
        .modal-backdrop{
            position:fixed; inset:0;
            background:rgba(0,0,0,.45);
            display:none;
            align-items:center;
            justify-content:center;
            padding:16px;
            z-index:9999;
        }
        .modal-backdrop.show{ display:flex; }
        .modal-box{
            width:min(560px, 100%);
            background:#fff;
            border-radius:14px;
            box-shadow:0 12px 40px rgba(0,0,0,.2);
            overflow:hidden;
        }
        .modal-header{
            display:flex; align-items:center; justify-content:space-between;
            padding:14px 16px;
            border-bottom:1px solid #eee;
        }
        .modal-title{ font-size:18px; font-weight:700; }
        .modal-close{
            border:none; background:transparent;
            font-size:22px; cursor:pointer; line-height:1;
        }
        .modal-body{ padding:16px; }
        .modal-footer{
            display:flex; gap:10px; justify-content:flex-end;
            padding:14px 16px;
            border-top:1px solid #eee;
        }
        .form-row{ margin-bottom:12px; }
        .form-row label{ display:block; font-weight:600; margin-bottom:6px; }
        .form-row select{
            width:100%;
            padding:10px 12px;
            border:1px solid #ddd;
            border-radius:10px;
            outline:none;
        }
        .hint{ font-size:13px; opacity:.8; margin-top:4px; }
    </style>
</head>
<body>

<div class="container">
    <div class="header">
        <h1>üìò TAEKWONDO - NGUY·ªÑN THI√äN PH·ª§NG</h1>
        <div>
            <!-- ‚úÖ N√öT SETTING (ai c≈©ng d√πng ƒë∆∞·ª£c) -->
            <a class="btn gray" href="#" id="btnOpenSetting">‚öôÔ∏è Setting</a>

            {% if current_user.role == "admin" %}
                <!-- ‚úÖ N√™n tr·ªè ƒë√∫ng v·ªÅ trang admin folder/questions -->
                <a class="btn" href="/admin/questions">‚ûï Admin</a>
            {% endif %}

            <a class="btn gray" href="/logout">ƒêƒÉng xu·∫•t</a>
        </div>
    </div>

    <!-- ‚úÖ Danh s√°ch B·ªô b√†i (Folder level 1) -->
    <div class="grid">
        {% for f1 in folder1_list %}
        <div class="card">
            <h3>{{ f1.name }}</h3>
            <a class="btn" href="/set/{{ f1.id }}">V√†o √¥n t·∫≠p</a>
        </div>
        {% endfor %}

        {% if folder1_list|length == 0 %}
        <div class="card">
            <h3>Ch∆∞a c√≥ b·ªô b√†i</h3>
            <div class="hint">V√†o Admin ƒë·ªÉ t·∫°o Folder c·∫•p 1 (B·ªô b√†i).</div>
        </div>
        {% endif %}
    </div>
</div>

<!-- ========== MODAL SETTING ========== -->
<div class="modal-backdrop" id="modalSetting">
    <div class="modal-box" role="dialog" aria-modal="true">
        <div class="modal-header">
            <div class="modal-title">‚öôÔ∏è C√†i ƒë·∫∑t l∆∞·ª£t √¥n t·∫≠p</div>
            <button class="modal-close" type="button" id="btnCloseSetting">√ó</button>
        </div>

        <!-- L∆∞u setting v√†o route /settings -->
        <form method="POST" action="/settings">
            <div class="modal-body">

                <div class="form-row">
                    <label>S·ªë gi√¢y cho 1 c√¢u</label>
                    <select name="time_per_q" required>
                        {% for s in [5,10,15,20,30,45,60] %}
                            <option value="{{s}}" {% if time_per_q==s %}selected{% endif %}>
                                {{s}} gi√¢y
                            </option>
                        {% endfor %}
                    </select>
                    <div class="hint">Ch·ªçn th·ªùi gian tr·∫£ l·ªùi cho m·ªói c√¢u.</div>
                </div>

                <div class="form-row">
                    <label>S·ªë c√¢u h·ªèi / l∆∞·ª£t</label>
                    <select name="num_questions" required>
                        {% for n in [10,15,20,30,45,60] %}
                            <option value="{{n}}" {% if num_questions==n %}selected{% endif %}>
                                {{n}} c√¢u
                            </option>
                        {% endfor %}
                    </select>
                    <div class="hint">N·∫øu ch·ªß ƒë·ªÅ c√≥ √≠t h∆°n s·ªë c√¢u ch·ªçn, h·ªá th·ªëng s·∫Ω l·∫•y t·ªëi ƒëa c√¢u hi·ªán c√≥.</div>
                </div>

            </div>

            <div class="modal-footer">
                <button class="btn gray" type="button" id="btnCancelSetting">Hu·ª∑</button>
                <button class="btn" type="submit">L∆∞u</button>
            </div>
        </form>
    </div>
</div>

<!-- Modal JS (thu·∫ßn) -->
<script>
    const modalS = document.getElementById('modalSetting');
    const openS  = document.getElementById('btnOpenSetting');
    const closeS = document.getElementById('btnCloseSetting');
    const cancelS= document.getElementById('btnCancelSetting');

    function openSetting(){
        modalS.classList.add('show');
    }
    function closeSetting(){
        modalS.classList.remove('show');
    }

    openS.addEventListener('click', (e)=>{ e.preventDefault(); openSetting(); });
    closeS.addEventListener('click', closeSetting);
    cancelS.addEventListener('click', closeSetting);

    modalS.addEventListener('click', (e)=>{ if(e.target === modalS) closeSetting(); });
    document.addEventListener('keydown', (e)=>{ if(e.key === 'Escape') closeSetting(); });
</script>

</body>
</html>
